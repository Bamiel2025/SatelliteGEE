# Google Earth Engine Authentication Guide

This guide explains how to connect your Google Earth Engine account to the Satellite Image Analyzer application.

## How Authentication Works

The Satellite Image Analyzer connects to Google Earth Engine using your personal Google account. The application uses the Earth Engine Python API to access satellite imagery and perform geospatial analysis.

## Prerequisites

1. A Google account (Gmail)
2. Access to Google Earth Engine (free registration required)
3. A Google Cloud Project with Earth Engine API enabled

## Understanding Google Cloud Project ID

**Important:** The Project ID is different from the project name!

- **Project Name**: Human-readable name you give your project (e.g., "My Satellite Project")
- **Project ID**: Unique identifier automatically generated by Google (e.g., "my-project-123456" or "satellite-analyzer-123456")

You need the **Project ID**, not the project name.

## Step-by-Step Authentication Process

### Step 1: Register for Google Earth Engine

1. Go to [Google Earth Engine](https://earthengine.google.com/)
2. Click "Sign up" and follow the registration process
3. Accept the Terms of Service

### Step 2: Create a Google Cloud Project

1. Go to the [Google Cloud Console](https://console.cloud.google.com/)
2. Click "Select a project" then "New Project"
3. Enter a project name (e.g., "satellite-analyzer")
4. Google will automatically generate a Project ID
5. Click "Create"

### Step 3: Find Your Project ID

1. In the Google Cloud Console, click the project dropdown at the top
2. Look for the **Project ID** column (not the project name)
3. It will look like: `my-project-123456` or `satellite-analyzer-123456`
4. Copy this exact Project ID

### Step 4: Enable Billing

1. In the Google Cloud Console, go to "Billing"
2. Link a billing account to your project
3. Note: Earth Engine has generous free quotas, but billing must be enabled

### Step 5: Enable Earth Engine API

1. In the Google Cloud Console, navigate to "APIs & Services" > "Library"
2. Search for "Earth Engine API"
3. Click on "Google Earth Engine API"
4. Click "Enable"

### Step 6: Register Your Project with Earth Engine

This is a **mandatory step** that many users miss:

1. Go to [Earth Engine Project Registration](https://code.earthengine.google.com/register)
2. Enter your Project ID in the URL: 
   `https://code.earthengine.google.com/register?project=YOUR_PROJECT_ID`
3. Replace `YOUR_PROJECT_ID` with your actual Project ID
4. Follow the registration process

### Step 7: Set Up Authentication

There are two ways to authenticate:

#### Method 1: Automatic Authentication (Recommended)

1. Run the authentication script:
   ```bash
   python gee_auth.py
   ```

2. A browser window will open asking you to sign in with your Google account
3. Grant the necessary permissions
4. The authentication token will be saved locally

#### Method 2: Manual Authentication

1. Set up application default credentials:
   ```bash
   gcloud auth application-default login
   ```

2. Set your project ID as an environment variable:
   ```bash
   # Windows
   set GEE_PROJECT_ID=your-actual-project-id-here
   
   # Linux/Mac
   export GEE_PROJECT_ID=your-actual-project-id-here
   ```

### Step 8: Configure Environment Variables

Edit the `.env` file in the project root with your project ID:

```
GEE_PROJECT_ID=your-actual-project-id-here
```

Replace `your-actual-project-id-here` with your actual Google Cloud project ID (the one that looks like `satellite-analyzer-123456`).

**Important:** Use the Project ID, not the project name!

## Verifying Authentication

To verify that authentication is working:

1. Run the test script:
   ```bash
   python test_gee_auth.py
   ```

2. Or start the server and check the console output:
   ```bash
   python server.py
   ```

If authentication is successful, you'll see:
```
âœ… Google Earth Engine initialized successfully
```

## Troubleshooting Authentication Issues

### "Failed to initialize Google Earth Engine" Error

This usually means one of the following:

1. **Incorrect Project ID**: Verify your project ID in the `.env` file
   - Use the Project ID, not the project name
   - It should look like: `my-project-123456` or `satellite-analyzer-123456`
2. **Missing Authentication**: Run `python gee_auth.py` to authenticate
3. **Project Not Registered**: Make sure you registered your project at https://code.earthengine.google.com/register?project=YOUR_PROJECT_ID
4. **Insufficient Permissions**: Ensure your Google account has Earth Engine access

### "Permission denied" Error

1. Check that you've enabled the Earth Engine API for your project
2. Verify that billing is enabled for your project
3. Ensure you're using the same Google account for Earth Engine and Google Cloud

### "Project not found" Error

1. Verify your project ID is correct (use Project ID, not project name)
2. Check that the project exists in the [Google Cloud Console](https://console.cloud.google.com/)
3. Ensure you have owner or editor permissions for the project
4. Make sure you've registered your project with Earth Engine

## Security Considerations

- Authentication tokens are stored locally and never transmitted over the internet
- The application only accesses Earth Engine data, not your personal Google data
- Environment variables prevent hardcoding sensitive information

## Advanced Configuration

### Service Account Authentication (for production)

For production deployments, you can use service account authentication:

1. Create a service account in the Google Cloud Console
2. Download the JSON key file
3. Set the environment variable:
   ```bash
   GOOGLE_APPLICATION_CREDENTIALS=/path/to/your/service-account-key.json
   ```

### Multiple Projects

If you have multiple Google Cloud projects, you can switch between them by changing the `GEE_PROJECT_ID` environment variable.

## Getting Help

If you continue to have authentication issues:

1. Check the [Earth Engine FAQ](https://developers.google.com/earth-engine/faq)
2. Review the [Authentication Documentation](https://developers.google.com/earth-engine/guides/auth)
3. Visit the [Earth Engine Community Forum](https://groups.google.com/forum/#!forum/google-earth-engine-developers)